// Generated by CoffeeScript 1.12.7
(function() {
  var save;

  save = function(event) {
    var client, orders;
    event.preventDefault();
    client = $('#client_id').val();
    orders = [];
    $('.selected').each(function() {
      return orders.push($(this).attr('data-id'));
    });
    return $.ajax({
      type: 'post',
      url: 'clients',
      data: {
        client: client,
        orders: orders,
        action: 'save_orders'
      },
      success: function(answer) {
        return successHandler(answer);
      },
      error: function(answer) {
        return errorHandler(answer);
      }
    });
  };

  $(document).on('click', '#search', function(event) {
    var client, data;
    event.preventDefault();
    data = {};
    client = $('#client_id').val();
    data['client'] = client;
    $('form .search').each(function() {
      if ($(this).val() !== '') {
        return data[$(this).attr('name')] = $(this).val();
      }
    });
    data.action = 'search_orders';
    return $.ajax({
      type: 'post',
      url: url('clients'),
      data: data,
      success: function(answer) {
        $('table .order_row').remove();
        $('table .recommended').remove();
        if (answer.length > 10) {
          $('table.search tbody').append(answer);
          return $('#save').css('display', 'block');
        } else {
          $('#save').css('display', 'none');
          return $('table.search tbody').append('<tr class="order_row"> <td colspan="5"> <h4 class="centered">Не знайдено, або вже прикріплено!</h4> </td> </tr>');
        }
      }
    });
  });

  $(document).on('click', '#save', save);

  $(document).on('click', '.order_row', function() {
    return $(this).toggleClass('selected');
  });

}).call(this);
